# ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë
# ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
# ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñë‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù
# ‚ñë‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñë‚ñë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
# ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñë‚ïö‚ïê‚ñà‚ñà‚ïî‚ïê‚ïù‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñë‚ñë‚ñà‚ñà‚ïë
# ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ñë‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ñë‚ñë‚ïö‚ïê‚ïù
# ---------------------------------------------------------------------------------------------
# Name: MineEVO-bossfarm
# Description: –ü–æ–ª–µ–∑–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è —Ñ–∞—Ä–º–∞ –±–æ—Å—Å–æ–≤ –≤ –±–æ—Ç–µ @mine_evo_bot
# Author: sqlmerr
# Commands:
# .mautoboss
# ---------------------------------------------------------------------------------------------

# –≤–µ—Ä—Å–∏—è –º–æ–¥—É–ª—è
__version__ = (1, 0, 1)
# meta developer: @sqlmerr_m
# only hikka

# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import asyncio

from telethon.tl.types import Message, ChatAdminRights
from telethon import events, functions, types

import logging

import re

from .. import loader, utils


logger = logging.getLogger(__name__)

# —Å–∞–º –∫–ª–∞—Å—Å –º–æ–¥—É–ª—è
@loader.tds
class MineEVO_bossfarm(loader.Module):
    """–ü–æ–ª–µ–∑–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è —Ñ–∞—Ä–º–∞ –±–æ—Å—Å–æ–≤ –≤ –±–æ—Ç–µ @mine_evo_bot"""
    # –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    strings = {
        "name": "MineEVO-bossfarm",
        "status": "–í–∫–ª—é—á–µ–Ω –ª–∏ –º–æ–¥—É–ª—å –∏–ª–∏ –Ω–µ—Ç",
        "boss": "–ö–∞–∫–æ–≥–æ –±–æ—Å—Å–∞ –±–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏? –ü–æ —Å—á—ë—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Å–ª–∞–π–º - 1, –∫–∞–º–µ–Ω–Ω—ã–π –≥–æ–ª–µ–º - 5)",
        "delay": "–í—Ä–µ–º—è –º–µ–∂–¥—É —á–µ–∫–∞–Ω—å–µ–º –±–æ—Å—Å–æ–≤"
    }
    async def client_ready(self):
        # —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–∞—Ç
        self._mineevoboss_channel, _ = await utils.asset_channel(
            self._client,
            "MineEVO-bosses - —á–∞—Ç",
            "–ù–µ –ø–∏—à–∏—Ç–µ —Å—é–¥–∞. –≠—Ç–æ—Ç —á–∞—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ—Ç –¥–ª—è –º–æ–¥—É–ª—è MineEVO-bosses –æ—Ç @sqlmerr_m",
            silent=True,
            archive=True,
            _folder="hikka",
        )
        # –≤ —ç—Ç–æ—Ç —á–∞—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –±–æ—Ç @mine_evo_bot
        await self.client(functions.channels.InviteToChannelRequest(self._mineevoboss_channel, ['@mine_evo_bot']))
        # –∏ —ç—Ç–æ–º—É –±–æ—Ç—É –≤—ã–¥–∞—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
        await self.client(functions.channels.EditAdminRequest(
                channel=self._mineevoboss_channel,
                user_id="@mine_evo_bot",
                admin_rights=ChatAdminRights(ban_users=True, post_messages=True, edit_messages=True),
                rank="MineEVO-bosses",
            )
        )

    # —Ñ—É–Ω–∫—Ü–∏—è, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –û–û–ü –∏ –Ω—É–∂–Ω–∞—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞
    def __init__(self):
        self.config = loader.ModuleConfig(
            loader.ConfigValue(
                "status",
                False,
                lambda: self.strings("status"),
                validator=loader.validators.Boolean()
            ),
            loader.ConfigValue(
                "boss",
                None,
                lambda: self.strings("boss"),
                validator=loader.validators.Integer()
            ),
            loader.ConfigValue(
                "delay",
                5,
                lambda: self.strings("delay"),
                validator=loader.validators.Integer()
            ),
        )

    # .mautosell
    @loader.command()
    async def mautoboss(self, message: Message):
        """–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ñ–∞—Ä–º –±–æ—Å—Å–æ–≤"""
        self.config["status"] = not self.config["status"]
        status = (
            "<emoji document_id=5409048419211682843>üí≤</emoji> –ê–≤—Ç–æ—Ñ–∞—Ä–º –±–æ—Å—Å–æ–≤ –≤–∫–ª—é—á–µ–Ω"
            if self.config["status"]
            else "<emoji document_id=5409048419211682843>üí≤</emoji> –ê–≤—Ç–æ—Ñ–∞—Ä–º –±–æ—Å—Å–æ–≤ –≤—ã–∫–ª—é—á–µ–Ω"
        )

        await utils.answer(message, "<emoji document_id=5314346928660554905>‚ö†Ô∏è</emoji> –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ñ–∞—Ä–º–∞ –±–æ—Å—Å–æ–≤:\n <b>{}</b>".format(status))
        self.config["status"]
        if self.config["status"]:
            while self.config["status"]:
                boss = self.config["boss"]
                if self.config["status"]:
                    async with self._client.conversation(self._mineevoboss_channel) as conv:
                        a = await conv.send_message('–ë–æ—Å—Å—ã')
                        # –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç
                        b = await conv.get_response()
                        list_msgs_id = [a.id, b.id]
                    await b.click(boss-1)
                    await asyncio.sleep(self.config["delay"])
                else:
                    return
                    break
        else:
            return

